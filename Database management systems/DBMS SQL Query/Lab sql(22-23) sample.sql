-- Chapter 7
-- Create Table CLIENT_MASTER 2 N0 VALUE INSERT JONNO
create table CLIENT_MASTER(
CLIENTNO Varchar(6),
NAME Varchar(20),
CITY Varchar(15),
PINCODE integer(8),
STATE Varchar(15),
BALDUE integer(10)
);

-- Insert Value in CLIENT_MASTER Table
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00001','Ivan Bayross','Mumbai',400054,'Maharashtra',15000);
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00002','Mamta Muzumdar','Madras',780001,'Tamil Nadu',0);
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00003','Chhaya Banker','Mumbai',400057,'Maharashtra',5000);
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00004','Ashwini Joshi','Bangalore',560001,'Karnataka',0);
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00005','Hansel Colaco','Mumbai',400060,'Maharashtra',2000);
INSERT INTO CLIENT_MASTER(CLIENTNO,NAME,CITY,PINCODE,STATE,BALDUE) VALUES('C00006','Deepak Sharma','Mangalore',560050,'Karnataka',0);

-- Show Data From Table 
select * From CLIENT_MASTER;

-- Create Table PRODUCT_MASTER 2 no value insert jonno
create table PRODUCT_MASTER(
PRODUCTNO Varchar(6),
DESCRIPTION Varchar(15),
PROFITPERCENT float(4),
UNITMEASURE Varchar(10),
QTYONHAND integer(8),
REORDERLVL integer(8),
SELLPRICE integer(8),
COSTPRICE float(8)
);

-- Insert Value in PRODUCT_MASTER Table
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P00001','T-Shirts',5,'Piece',200,50,350,250);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P0345','Shirts',6,'Piece',150,50,500,350);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P06734','Cotton Jeans',5,'Piece',100,20,600,450);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P07865','Jeans',5,'Piece',100,20,750,500);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P07868','Trousers',2,'Piece',150,50,850,550);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P07885','Pull Overs',2.5,'Piece',80,30,700,450);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P07965','Denim Shirts',4,'Piece',100,40,350,250);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P07975','Lycra Tops',5,'Piece',70,30,300,175);
INSERT INTO PRODUCT_MASTER(PRODUCTNO,DESCRIPTION,PROFITPERCENT,UNITMEASURE,QTYONHAND,REORDERLVL,SELLPRICE,COSTPRICE) VALUES('P08865','Skirts',5,'Piece',75,30,450,300);

-- Show Data From Table 
select * From PRODUCT_MASTER;

-- Create Table SALESMAN_MASTER 1 no
create table SALESMAN_MASTER(
SALESMANNO Varchar(6),
NAME Varchar(20),
ADDRESS1 Varchar(30),
ADDRESS2 Varchar(30),
CITY Varchar(20),
PINCODE integer(8),
STATE Varchar(20),
SALAMT integer(8),
TGTTOGET integer(6),
YTDSALES integer(6),
REMARKS Varchar(60)
);

-- Insert Value in SALESMAN_MASTER Table
INSERT INTO SALESMAN_MASTER(SALESMANNO,NAME,ADDRESS1,ADDRESS2,CITY,PINCODE,STATE,SALAMT,TGTTOGET,YTDSALES,REMARKS) VALUES('S00001','Aman','A/14','Worli','Mumbai',400002,'Maharashtra',3000,100,50,'Good');
INSERT INTO SALESMAN_MASTER(SALESMANNO,NAME,ADDRESS1,ADDRESS2,CITY,PINCODE,STATE,SALAMT,TGTTOGET,YTDSALES,REMARKS) VALUES('S00002','Omkar','65','Nariman','Mumbai',400001,'Maharashtra',3000,200,100,'Good');
INSERT INTO SALESMAN_MASTER(SALESMANNO,NAME,ADDRESS1,ADDRESS2,CITY,PINCODE,STATE,SALAMT,TGTTOGET,YTDSALES,REMARKS) VALUES('S00003','Raj','P-7','Bandra','Mumbai',400032,'Maharashtra',3000,200,100,'Good');
INSERT INTO SALESMAN_MASTER(SALESMANNO,NAME,ADDRESS1,ADDRESS2,CITY,PINCODE,STATE,SALAMT,TGTTOGET,YTDSALES,REMARKS) VALUES('S00004','Ashish','A/5','Juhu','Mumbai',400044,'Maharashtra',3500,200,150,'Good');

-- Show Data From Table 
select * From SALESMAN_MASTER;


-------------------------------------------------------------------
-- Chapter 8

-- Create Database
create DATABASE DBMS_CH_8;
USE DBMS_CH_8;
use DBMS_CH_7;


-- 2.a (1st use dbms_ch_7,2nd use dbms_ch_8 run korbo,then ai query)
-- because last jei database run korbo oi database a operation hobe

-- Create Table CLIENT_MASTER 2.a NO
create table CLIENT_MASTER(
CLIENTNO Varchar(6),
primary key (CLIENTNO),
check (CLIENTNO like 'C%'),
NAME Varchar(20) not null,
CITY Varchar(15),
PINCODE integer(8),
STATE Varchar(15),
BALDUE integer(10)
);


-- Create Table PRODUCT_MASTER 2.a no
create table PRODUCT_MASTER(
PRODUCTNO Varchar(6),
primary key (PRODUCTNO),
check (PRODUCTNO like 'P%'),
DESCRIPTION Varchar(15) not null,
PROFITPERCENT integer(4) not null,
UNITMEASURE Varchar(10) not null ,
QTYONHAND integer(8) not null,
REORDERLVL integer(8) not null,
SELLPRICE integer(8) not null,
check (SELLPRICE !=0),
COSTPRICE integer(8) not null,
check (COSTPRICE !=0)
);

-- Create Table SALESMAN_MASTER 2.a no
create table SALESMAN_MASTER(
SALESMANNO Varchar(6),
primary key (SALESMANNO),
check (SALESMANNO like 'S%'),
SALESMANNAME Varchar(20) NOT NULL,
ADDRESS1 Varchar(30) not null,
ADDRESS2 Varchar(30),
CITY Varchar(20),
PINCODE integer(8),
STATE Varchar(20),
SALAMT integer(8) not null,
check (SALAMT !=0),
TGTTOGET integer(6) not null,
check (TGTTOGET !=0),
YTDSALES integer(6) not null,
REMARKS Varchar(60)
);




insert into CLIENT_MASTER select * from DBMS_CH_7.CLIENT_MASTER;
insert into PRODUCT_MASTER select * from DBMS_CH_7.PRODUCT_MASTER;
insert into SALESMAN_MASTER select * from DBMS_CH_7.SALESMAN_MASTER;

-- 2.b 
-- Create Table SALES_ORDER 2.b no
create table SALES_ORDER(
ORDERNO Varchar(6),
primary key (ORDERNO),
check (ORDERNO like 'O%'),
CLIENTNO Varchar(6),
foreign key (CLIENTNO) references CLIENT_MASTER (CLIENTNO),
ORDERDATE date not null,
SALESMANNO Varchar(6),
foreign key (SALESMANNO) references SALESMAN_MASTER(SALESMANNO),
DELYTYPE Char(1) default 'F',
check(DELYTYPE in ('P','F')),
BILLYN Char(1),
DELYDATE date,
check (DELYDATE < ORDERDATE),
ORDERSTATUS Varchar(10),
check (ORDERSTATUS in ('In Process','Fulfilled','BackOrder','Cancelled'))
);


INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O19001','C00001',str_to_date('12-June-04','%d-%M-%y'),'S00001','F','N',str_to_date('20-July-02','%d-%M-%y'),'In Process');
INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O19002','C00002',str_to_date('25-June-04','%d-%M-%y'),'S00002','F','N',str_to_date('27-June-02','%d-%M-%y'),'Cancelled');
INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O46865','C00003',str_to_date('18-Feb-04','%d-%M-%y'),'S00003','F','Y',str_to_date('20-Feb-02','%d-%M-%y'),'Fulfilled');
INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O19003','C00001',str_to_date('03-Apr-04','%d-%M-%y'),'S00001','F','Y',str_to_date('07-Apr-02','%d-%M-%y'),'Fulfilled');
INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O46866','C00004',str_to_date('20-May-04','%d-%M-%y'),'S00002','F','N',str_to_date('22-May-02','%d-%M-%y'),'Cancelled');
INSERT INTO SALES_ORDER(ORDERNO,CLIENTNO,ORDERDATE,SALESMANNO,DELYTYPE,BILLYN,DELYDATE,ORDERSTATUS) VALUES('O19008','C00005',str_to_date('24-May-04','%d-%M-%y'),'S00004','F','N',str_to_date('26-July-02','%d-%M-%y'),'In Process');

select * From SALES_ORDER;

-- 2.c 

-- Create Table SALES_ORDER_DETAILS 1 no
create table SALES_ORDER_DETAILS(
ORDERNO Varchar(6),
foreign key (ORDERNO) references SALES_ORDER (ORDERNO),
PRODUCTNO Varchar(6),
foreign key (PRODUCTNO) references PRODUCT_MASTER(PRODUCTNO),
QTYORDERED Varchar(6),
QTYDISP integer(8),
PRODUCTRATE integer(10)
);

INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19001','P00001',4,4,525);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19001','P07965',2,1,8400);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19001','P07885',2,1,5250);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19002','P00001',10,0,525);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46865','P07868',3,3,3150);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46865','P07885',3,1,5250);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46865','P00001',10,10,525);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46865','P0345',4,4,1050);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19003','P03453',2,2,1050);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19003','P06734',1,1,12000);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46866','P07965',1,0,8400);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O46866','P07975',1,0,1050);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19008','P00001',10,5,525);
INSERT INTO SALES_ORDER_DETAILS(ORDERNO,PRODUCTNO,QTYORDERED ,QTYDISP,PRODUCTRATE) VALUES('O19008','P07975',5,3,1050);

select * from SALES_ORDER_DETAILS;

